
    <header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1">Resolving zone pollution</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/best-practices/runtime-performance/zone-pollution.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p><strong>Zone.js</strong> is a signaling mechanism that Angular uses to detect when an application state might have changed. It captures asynchronous operations like <code>setTimeout</code>, network requests, and event listeners. Angular schedules change detection based on signals from Zone.js.</p>
<p>In some cases scheduled <a href="https://developer.mozilla.org/docs/Web/API/HTML_DOM_API/Microtask_guide#tasks" target="_blank">tasks</a> or <a href="https://developer.mozilla.org/docs/Web/API/HTML_DOM_API/Microtask_guide#microtasks" target="_blank">microtasks</a> don’t make any changes in the data model, which makes running change detection unnecessary. Common examples are:</p>

  <ul class="docs-list">
    <li><code>requestAnimationFrame</code>, <code>setTimeout</code> or <code>setInterval</code></li>
<li>Task or microtask scheduling by third-party libraries</li>

  </ul>
  <p>This section covers how to identify such conditions, and how to run code outside the Angular zone to avoid unnecessary change detection calls.</p>

  <h2 id="identifying-unnecessary-change-detection-calls">
    <a href="#identifying-unnecessary-change-detection-calls" class="docs-anchor" tabindex="-1" aria-label="Link to Identifying unnecessary change detection calls">Identifying unnecessary change detection calls</a>
  </h2>
  <p>You can detect unnecessary change detection calls using Angular DevTools. Often they appear as consecutive bars in the profiler’s timeline with source <code>setTimeout</code>, <code>setInterval</code>, <code>requestAnimationFrame</code>, or an event handler. When you have limited calls within your application of these APIs, the change detection invocation is usually caused by a third-party library.</p>
<img alt="Angular DevTools profiler preview showing Zone pollution" src="assets/images/best-practices/runtime-performance/zone-pollution.png">

<p>In the image above, there is a series of change detection calls triggered by event handlers associated with an element. That’s a common challenge when using third-party, non-native Angular components, which do not alter the default behavior of <a href="/api/core/NgZone"><code>NgZone</code></a>.</p>

  <h2 id="run-tasks-outside-ngzone">
    <a href="#run-tasks-outside-ngzone" class="docs-anchor" tabindex="-1" aria-label="Link to Run tasks outside <code>NgZone</code>">Run tasks outside <code>NgZone</code></a>
  </h2>
  <p>In such cases, you can instruct Angular to avoid calling change detection for tasks scheduled by a given piece of code using <a href="/api/core/NgZone">NgZone</a>.</p>
<div class="docs-code" header="Run outside of the Zone">
    <div class="docs-code-header"><h3>Run outside of the Zone</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span role="presentation" class="shiki-ln-number">1</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { <a href="/api/core/Component">Component</a>, NgZone, OnInit } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">2</span><span class="line"></span><span role="presentation" class="shiki-ln-number">3</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span><span role="presentation" class="shiki-ln-number">4</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/OnInit">OnInit</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">5</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> ngZone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(<a href="/api/core/NgZone">NgZone</a>);</span></span><span role="presentation" class="shiki-ln-number">6</span><span class="line"></span><span role="presentation" class="shiki-ln-number">7</span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ngOnInit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span role="presentation" class="shiki-ln-number">8</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.ngZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">runOutsideAngular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(pollForUpdates), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span role="presentation" class="shiki-ln-number">9</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span role="presentation" class="shiki-ln-number">10</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>The preceding snippet instructs Angular to call <code>setInterval</code> outside the Angular Zone and skip running change detection after <code>pollForUpdates</code> runs.</p>
<p>Third-party libraries commonly trigger unnecessary change detection cycles when their APIs are invoked within the Angular zone. This phenomenon particularly affects libraries that set up event listeners or initiate other tasks (such as timers, XHR requests, etc.). Avoid these extra cycles by calling library APIs outside the Angular zone:</p>
<div class="docs-code" header="Move the plot initialization outside of the Zone">
    <div class="docs-code-header"><h3>Move the plot initialization outside of the Zone</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span role="presentation" class="shiki-ln-number">1</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { <a href="/api/core/Component">Component</a>, NgZone, OnInit } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">2</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Plotly </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'plotly.js-dist-min'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">3</span><span class="line"></span><span role="presentation" class="shiki-ln-number">4</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span><span role="presentation" class="shiki-ln-number">5</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/OnInit">OnInit</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">6</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> ngZone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(<a href="/api/core/NgZone">NgZone</a>);</span></span><span role="presentation" class="shiki-ln-number">7</span><span class="line"></span><span role="presentation" class="shiki-ln-number">8</span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ngOnInit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span role="presentation" class="shiki-ln-number">9</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.ngZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">runOutsideAngular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">10</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      Plotly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">newPlot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'chart'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, data);</span></span><span role="presentation" class="shiki-ln-number">11</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span role="presentation" class="shiki-ln-number">12</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span role="presentation" class="shiki-ln-number">13</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>Running <code>Plotly.newPlot(&#39;chart&#39;, data);</code> within <code>runOutsideAngular</code> instructs the framework that it shouldn’t run change detection after the execution of tasks scheduled by the initialization logic.</p>
<p>For example, if <code>Plotly.newPlot(&#39;chart&#39;, data)</code> adds event listeners to a DOM element, Angular does not run change detection after the execution of their handlers.</p>
<p>But sometimes, you may need to listen to events dispatched by third-party APIs. In such cases, it's important to remember that those event listeners will also execute outside of the Angular zone if the initialization logic was done there:</p>
<div class="docs-code" header="Check whether the handler is called outside of the Zone">
    <div class="docs-code-header"><h3>Check whether the handler is called outside of the Zone</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span role="presentation" class="shiki-ln-number">1</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { <a href="/api/core/Component">Component</a>, NgZone, OnInit, output } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">2</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Plotly </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'plotly.js-dist-min'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">3</span><span class="line"></span><span role="presentation" class="shiki-ln-number">4</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span><span role="presentation" class="shiki-ln-number">5</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/OnInit">OnInit</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">6</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> ngZone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(<a href="/api/core/NgZone">NgZone</a>);</span></span><span role="presentation" class="shiki-ln-number">7</span><span class="line"></span><span role="presentation" class="shiki-ln-number">8</span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  plotlyClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/output">output</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Plotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PlotMouseEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;();</span></span><span role="presentation" class="shiki-ln-number">9</span><span class="line"></span><span role="presentation" class="shiki-ln-number">10</span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ngOnInit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span role="presentation" class="shiki-ln-number">11</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.ngZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">runOutsideAngular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">12</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createPlotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span role="presentation" class="shiki-ln-number">13</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span role="presentation" class="shiki-ln-number">14</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span role="presentation" class="shiki-ln-number">15</span><span class="line"></span><span role="presentation" class="shiki-ln-number">16</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> createPlotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span role="presentation" class="shiki-ln-number">17</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> plotly</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Plotly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">newPlot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'chart'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, data);</span></span><span role="presentation" class="shiki-ln-number">18</span><span class="line"></span><span role="presentation" class="shiki-ln-number">19</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    plotly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'plotly_click'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Plotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PlotMouseEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">20</span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // This handler will be called outside of the Angular zone because</span></span><span role="presentation" class="shiki-ln-number">21</span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // the initialization logic is also called outside of the zone. To check</span></span><span role="presentation" class="shiki-ln-number">22</span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // whether we're in the Angular zone, we can call the following:</span></span><span role="presentation" class="shiki-ln-number">23</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(<a href="/api/core/NgZone">NgZone</a>.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isInAngularZone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">());</span></span><span role="presentation" class="shiki-ln-number">24</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.plotlyClick.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(event);</span></span><span role="presentation" class="shiki-ln-number">25</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span role="presentation" class="shiki-ln-number">26</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span role="presentation" class="shiki-ln-number">27</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>If you need to dispatch events to parent components and execute specific view update logic, you should consider re-entering the Angular zone to instruct the framework to run change detection or run change detection manually:</p>
<div class="docs-code" header="Re-enter the Angular zone when dispatching event">
    <div class="docs-code-header"><h3>Re-enter the Angular zone when dispatching event</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span role="presentation" class="shiki-ln-number">1</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { <a href="/api/core/Component">Component</a>, NgZone, OnInit, output } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">2</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Plotly </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'plotly.js-dist-min'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span role="presentation" class="shiki-ln-number">3</span><span class="line"></span><span role="presentation" class="shiki-ln-number">4</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span><span role="presentation" class="shiki-ln-number">5</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/OnInit">OnInit</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">6</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> ngZone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(<a href="/api/core/NgZone">NgZone</a>);</span></span><span role="presentation" class="shiki-ln-number">7</span><span class="line"></span><span role="presentation" class="shiki-ln-number">8</span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  plotlyClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/output">output</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Plotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PlotMouseEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;();</span></span><span role="presentation" class="shiki-ln-number">9</span><span class="line"></span><span role="presentation" class="shiki-ln-number">10</span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ngOnInit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span role="presentation" class="shiki-ln-number">11</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.ngZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">runOutsideAngular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">12</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createPlotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span role="presentation" class="shiki-ln-number">13</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span role="presentation" class="shiki-ln-number">14</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span role="presentation" class="shiki-ln-number">15</span><span class="line"></span><span role="presentation" class="shiki-ln-number">16</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> createPlotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span role="presentation" class="shiki-ln-number">17</span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> plotly</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Plotly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">newPlot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'chart'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, data);</span></span><span role="presentation" class="shiki-ln-number">18</span><span class="line"></span><span role="presentation" class="shiki-ln-number">19</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    plotly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'plotly_click'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Plotly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PlotMouseEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">20</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.ngZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span role="presentation" class="shiki-ln-number">21</span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.plotlyClick.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(event);</span></span><span role="presentation" class="shiki-ln-number">22</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      });</span></span><span role="presentation" class="shiki-ln-number">23</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span role="presentation" class="shiki-ln-number">24</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span role="presentation" class="shiki-ln-number">25</span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>The scenario of dispatching events outside of the Angular zone may also arise. It's important to remember that triggering change detection (for example, manually) may result in the creation/update of views outside of the Angular zone.</p>
