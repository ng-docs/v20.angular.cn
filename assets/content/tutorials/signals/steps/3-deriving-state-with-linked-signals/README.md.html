<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1">使用链接信号派生状态</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/tutorials/signals/steps/3-deriving-state-with-linked-signals/README.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p>既然您已经学习了<a href="/tutorials/signals/2-deriving-state-with-computed-signals">如何使用 computed 信号派生状态</a>，您已经为 <code>notificationsEnabled</code> 创建了一个 computed 信号，该信号会自动跟踪您的用户状态。但是，如果用户希望在在线时手动禁用通知，该怎么办？这时就需要用到链接信号了。</p>
<p>链接信号是可写信号，它们与其源信号保持响应式连接。它们非常适合创建通常遵循计算但可在需要时被覆盖的状态。</p>
<p>在此活动中，您将通过将先前用户状态系统的 computed <code>notificationsEnabled</code> 增强为可写的链接信号，来学习 <code>linkedSignal()</code> 与 <code>computed()</code> 的区别。</p>
<hr>


    <ol class="docs-steps">
      
    <li>
      <span class="docs-step-number" aria-hidden="true"></span>
      
  <h3 id="import-linkedsignal-function">
    <a href="#import-linkedsignal-function" class="docs-anchor" tabindex="-1" aria-label="Link to Import linkedSignal function">导入 linkedSignal 函数</a>
  </h3>
  
      <p>将 <code>linkedSignal</code> 添加到您现有的导入中。</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Add linkedSignal to existing imports</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {Component, signal, computed, linkedSignal, ChangeDetectionStrategy} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
  </div>
    </li>
    
    <li>
      <span class="docs-step-number" aria-hidden="true"></span>
      
  <h3 id="convert-computed-to-linkedsignal-with-the-same-expression">
    <a href="#convert-computed-to-linkedsignal-with-the-same-expression" class="docs-anchor" tabindex="-1" aria-label="Link to Convert computed to linkedSignal with the same expression">使用相同的表达式将 computed 转换为 linkedSignal</a>
  </h3>
  
      <p>使用完全相同的表达式，将 computed <code>notificationsEnabled</code> 替换为 linkedSignal：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Previously (from lesson 2):</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// notificationsEnabled = computed(() =&gt; this.userStatus() === 'online');</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Now with linkedSignal - same expression, but writable:</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">notificationsEnabled </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> linkedSignal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">userStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'online'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
  </div><p>表达式是相同的，但 linkedSignal 创建了一个可写信号。当 <code>userStatus</code> 更改时，它仍会自动更新，但您也可以手动设置它。</p>

    </li>
    
    <li>
      <span class="docs-step-number" aria-hidden="true"></span>
      
  <h3 id="add-a-method-to-manually-toggle-notifications">
    <a href="#add-a-method-to-manually-toggle-notifications" class="docs-anchor" tabindex="-1" aria-label="Link to Add a method to manually toggle notifications">添加一个手动切换通知的方法</a>
  </h3>
  
      <p>添加一个方法来演示链接信号可以直接写入：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">toggleNotifications</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // This works with linkedSignal but would error with computed!</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.notificationsEnabled.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">notificationsEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">());</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>这是关键区别：computed 信号是只读的，但链接信号可以手动更新，同时保持其响应式连接。</p>

    </li>
    
    <li>
      <span class="docs-step-number" aria-hidden="true"></span>
      
  <h3 id="update-the-template-to-add-manual-notification-control">
    <a href="#update-the-template-to-add-manual-notification-control" class="docs-anchor" tabindex="-1" aria-label="Link to Update the template to add manual notification control">更新模板以添加手动通知控件</a>
  </h3>
  
      <p>更新您的模板以添加一个用于通知的切换按钮：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"status-info"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"notifications"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">strong</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Notifications:&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">strong</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    @if (notificationsEnabled()) {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      Enabled</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    } @else {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      Disabled</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> (click)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"toggleNotifications()"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"override-btn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      @if (notificationsEnabled()) {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        Disable</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      } @else {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        Enable</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  &lt;!-- existing message and working-hours divs remain --&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div>
    </li>
    
    <li>
      <span class="docs-step-number" aria-hidden="true"></span>
      
  <h3 id="observe-the-reactive-behavior">
    <a href="#observe-the-reactive-behavior" class="docs-anchor" tabindex="-1" aria-label="Link to Observe the reactive behavior">观察响应式行为</a>
  </h3>
  
      <p>现在测试该行为：</p>

    <ol class="docs-ordered-list">
      <li>更改用户状态 - 注意 <code>notificationsEnabled</code> 如何自动更新</li>
<li>手动切换通知 - 它会覆盖 computed 值</li>
<li>再次更改状态 - 链接信号与其计算重新同步</li>

    </ol>
    <p>这表明链接信号即使在手动设置后也能保持其响应式连接！</p>

    </li>
    
    </ol>
    <p>太棒了！您已经了解了 computed 和 linked 信号之间的关键区别：</p>

  <ul class="docs-list">
    <li><strong>Computed 信号</strong>：只读，始终从其他信号派生</li>
<li><strong>链接信号</strong>：可写，既可以派生又可以手动更新</li>
<li><strong>何时使用 computed</strong>：值应始终被计算</li>
<li><strong>何时使用 linkedSignal</strong>：您需要一个可以被覆盖的默认计算</li>

  </ul>
  <p>在下一课中，您将学习<a href="/tutorials/signals/4-managing-async-data-with-signals">如何使用信号管理异步数据</a>！</p>
