<div class="docs-api"><header class="docs-reference-header"><span class="docs-reference-category">@angular/upgrade/static</span><div class="docs-reference-title"><div><h1>UpgradeModule</h1><div class="docs-api-item-label type-ng_module full">NgModule</div><div class="docs-api-item-label type-stable full">stable</div></div><a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/blob/main/packages/upgrade/static/src/upgrade_module.ts#L148-L364" title="View source" aria-label="View source"><i role="presentation" aria-hidden="true" class="material-symbols-outlined">代码</i></a></div><section class="docs-reference-description"><p>一个 <a href="/api/core/NgModule"><code>NgModule</code></a>，您导入它以提供 AngularJS 核心服务，
并具有一个用于引导混合升级应用的实例方法。</p></section></header><div class="docs-reference-section docs-reference-api-section"><h2 id="api" class="docs-reference-section-heading"><a href="#api" aria-label="Link to API section" tabindex="-1">API</a></h2><div class="docs-code"><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0">    <code>
      <span class="line "><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><button aria-describedby="jump-msg" type="button" class="line " member-id="constructor"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/Injector">Injector</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">ngZone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/NgZone">NgZone</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">platformRef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/PlatformRef">PlatformRef</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="$injector"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  $injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="injector"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/Injector">Injector</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="ngZone"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  override</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> ngZone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/NgZone">NgZone</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="bootstrap"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  bootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">modules</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><span class="line "><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
    </code>
    </pre></div></div><div class="docs-reference-members"><div class="docs-reference-members"><div id="constructor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>constructor</h3><code><a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">injector</span><code><a href="/api/core/Injector">Injector</a></code><div class="docs-parameter-description"><p>升级应用的根 <a href="/api/core/Injector"><code>Injector</code></a>。</p></div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">ngZone</span><code><a href="/api/core/NgZone">NgZone</a></code><div class="docs-parameter-description"><p>升级应用的启动 Zone</p></div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">platformRef</span><code><a href="/api/core/PlatformRef">PlatformRef</a></code><div class="docs-parameter-description"><p>所属的 <a href="/api/core/NgModuleRef"><code>NgModuleRef</code></a> 的 <a href="/api/core/PlatformRef"><code>PlatformRef</code></a> 实例。
这用于将引导的 AngularJS 应用的生命周期与 Angular 的 <a href="/api/core/PlatformRef"><code>PlatformRef</code></a> 联系起来。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a></code></div></div></div></div><div id="$injector" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>$injector</h3><code>any</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>用于升级应用的 AngularJS <code>$injector</code>。</p></div></div></div></div><div id="injector" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>injector</h3><code><a href="/api/core/Injector">Injector</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>Angular 的注入器 *</p></div></div></div></div><div id="ngZone" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>ngZone</h3><code><a href="/api/core/NgZone">NgZone</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>升级应用的启动 Zone</p></div></div></div></div><div id="bootstrap" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>bootstrap</h3><code>any</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>从此 NgModule 启动一个 AngularJS 应用</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">element</span><code>Element</code><div class="docs-parameter-description"><p>要在其上启动 AngularJS 应用的元素</p></div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">modules</span><code>string[]</code><div class="docs-parameter-description"><p>要为此应用启动的 AngularJS 模块</p></div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">config</span><code>any</code><div class="docs-parameter-description"><p>可选的额外 AngularJS 启动配置</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>any</code></div></div></div></div></div></div><div class="docs-reference-section"><h2 id="description" class="docs-reference-section-heading"><a href="#description" aria-label="Link to Description section" tabindex="-1">描述</a></h2><div><p>一个 <a href="/api/core/NgModule"><code>NgModule</code></a>，您导入它以提供 AngularJS 核心服务，
并具有一个用于引导混合升级应用的实例方法。</p>
<p><em>支持预先编译的混合升级应用的 <a href="api?query=upgrade/static">upgrade/static</a> 库的一部分</em></p>
<p><code>upgrade/static</code> 包中包含一些辅助程序，它们允许 AngularJS 和 Angular 组件在支持预先编译的混合升级应用中一起使用。</p>
<p>具体来说，<code>upgrade/static</code> 模块中的类和函数允许以下操作：</p>

    <ol class="docs-ordered-list">
      <li>创建包装并公开 AngularJS 组件的 Angular 指令，以便
可以在 Angular 模板中使用它。请参阅 <a href="/api/upgrade/static/UpgradeComponent"><code>UpgradeComponent</code></a>。</li>
<li>创建包装并公开 Angular 组件的 AngularJS 指令，以便
可以在 AngularJS 模板中使用它。请参阅 <a href="/api/upgrade/static/downgradeComponent"><code>downgradeComponent</code></a>。</li>
<li>创建一个 Angular 根注入器提供者，它可以包装和公开一个 AngularJS 服务，以便它可以注入到 Angular 上下文中。请参阅下面的<a href="/api/upgrade/static/UpgradeModule#upgrading-an-angular-1-service"><code>升级 AngularJS 服务</code></a>。</li>
<li>创建包装并公开 Angular 可注入项的 AngularJS 服务，以便
可以将其注入到 AngularJS 上下文中。请参阅 <a href="/api/upgrade/static/downgradeInjectable"><code>downgradeInjectable</code></a>。</li>
<li>启动一个混合 Angular 应用，其中包含在单个应用中共存的两个框架。</li>

    </ol></div></div><div class="docs-reference-section"><h2 id="usage-notes" class="docs-reference-section-heading"><a href="#usage-notes" aria-label="Link to Usage Notes section" tabindex="-1">用法说明</a></h2><div><div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {<a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a>} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/upgrade/static'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
  </div><p>另请参阅下面的 <a href="/api/upgrade/static/UpgradeModule#examples"><code>范例</code></a>。</p>

  <h3 id="mental-model">
    <a href="#mental-model" class="docs-anchor" tabindex="-1" aria-label="Link to Mental Model">心智模型</a>
  </h3>
  <p>当推理混合应用如何工作时，拥有一个心智模型会很有用，该模型描述了正在发生的事情，并解释了在最低级别上正在发生的事情。</p>

    <ol class="docs-ordered-list">
      <li>在单个应用中运行着两个独立的框架，每个框架都将另一个框架视为黑盒。</li>
<li>页面上的每个 DOM 元素都恰好归一个框架所有。无论哪个框架实例化了该元素，该框架就是所有者。每个框架仅更新/与其自己的 DOM 元素交互，而忽略其他元素。</li>
<li>无论 AngularJS 指令在何处实例化，它们始终在 AngularJS 框架代码库内部执行。</li>
<li>无论 Angular 组件在何处实例化，它们始终在 Angular 框架代码库内部执行。</li>
<li>AngularJS 组件可以被“升级”为 Angular 组件。这是通过定义一个 Angular 指令来实现的，该指令在 DOM 中的位置引导 AngularJS 组件。请参阅 <a href="/api/upgrade/static/UpgradeComponent"><code>UpgradeComponent</code></a>。</li>
<li>Angular 组件可以被“降级”为 AngularJS 组件。这是通过定义一个 AngularJS 指令来实现的，该指令在 DOM 中的位置引导 Angular 组件。请参阅 <a href="/api/upgrade/static/downgradeComponent"><code>downgradeComponent</code></a>。</li>
<li>每当实例化“升级”/“降级”组件时，宿主元素都归执行实例化的框架所有。然后，另一个框架实例化并拥有该组件的视图。<ol class="docs-ordered-list">
      <li>这意味着组件绑定将始终遵循实例化框架的语义。</li>
<li>DOM Attribute 由拥有当前模板的框架解析。因此，AngularJS 模板中的 Attribute 必须使用 kebab-case，而 AngularJS 模板必须使用 camelCase。</li>
<li>但是，模板绑定语法将始终使用 Angular 风格，例如，方括号 (<code>[...]</code>) 用于属性（Property）绑定。</li>

    </ol>
    </li>
<li>Angular 首先启动；AngularJS 其次启动。AngularJS 始终拥有应用的根组件。</li>
<li>新的应用运行在 Angular Zone 中，因此不再需要调用 <code>$apply()</code>。</li>

    </ol>
    
  <h3 id="the-upgrademodule-class">
    <a href="#the-upgrademodule-class" class="docs-anchor" tabindex="-1" aria-label="Link to The <code><a href=" api upgrade static upgrademodule_>UpgradeModule</a> class"&gt;The <code><a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a></code> class
  </h3>
  <p>此类是一个 <a href="/api/core/NgModule"><code>NgModule</code></a>，您导入它以提供 AngularJS 核心服务，并具有一个用于引导混合升级应用程序的实例方法。</p>

  <ul class="docs-list">
    <li><p>核心 AngularJS 服务<br>
导入此 <a href="/api/core/NgModule"><code>NgModule</code></a> 将为根注入器添加核心 <a href="https://docs.angularjs.org/api/ng/service" target="_blank">AngularJS 服务</a> 的提供者。</p>
</li>
<li><p>启动引导<br>这个类的运行时实例包含一个 <a href="/api/upgrade/static/UpgradeModule#bootstrap"><code><code>bootstrap()</code></code></a> 方法，你可以使用它把顶层的 AngularJS 模块启动引导到混合升级应用的 DOM 元素上。</p>
<p>它还包含访问 <a href="/api/upgrade/static/UpgradeModule#injector"><code>根注入器</code></a>、引导 <a href="/api/core/NgZone"><code>NgZone</code></a> 和 <a href="https://docs.angularjs.org/api/auto/service/$injector" target="_blank">AngularJS $injector</a> 的属性。</p>
</li>

  </ul>
  
  <h3 id="examples">
    <a href="#examples" class="docs-anchor" tabindex="-1" aria-label="Link to Examples">范例</a>
  </h3>
  <p>将 <a href="/api/upgrade/static/UpgradeModule"><code>UpgradeModule</code></a> 导入到您的顶级 Angular <a href="/api/core/NgModule"><code>NgModule</code></a> 中。</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// This NgModule represents the Angular pieces of the application</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/NgModule">NgModule</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  declarations: [Ng2HeroesComponent, Ng1HeroComponentWrapper],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    HeroesService,</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Register an Angular provider whose value is the "upgraded" AngularJS service</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    {provide: TextFormatter, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">useFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> i.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'textFormatter'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">), deps: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'$injector'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]},</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ],</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // We must import `UpgradeModule` to get access to the AngularJS core services</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  imports: [BrowserModule, UpgradeModule],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Ng2AppModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>然后将 <a href="/api/upgrade/static/UpgradeModule"><code>UpgradeModule</code></a> 注入到您的 Angular <a href="/api/core/NgModule"><code>NgModule</code></a> 中，并使用它在 <code>ngDoBootstrap()</code> 方法中引导顶级 <a href="https://docs.angularjs.org/api/ng/type/angular.Module" target="_blank">AngularJS 模块</a>。</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Ng2AppModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> upgrade</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/upgrade/static/UpgradeModule">UpgradeModule</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {}</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ngDoBootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // We bootstrap the AngularJS app.</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.upgrade.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">bootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(document.body, [ng1AppModule.name]);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>最后，通过引导您的顶级 Angular <a href="/api/core/NgModule"><code>NgModule</code></a> 来启动整个过程。</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// We bootstrap the Angular module as we would do in a normal Angular app.</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// (We are using the dynamic browser platform as this example has not been compiled AOT.)</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/platform-browser/platformBrowser">platformBrowser</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">bootstrapModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Ng2AppModule);</span></span></code></pre>
  </div>
  <h3 id="upgrading-an-angularjs-service">
    <a href="#upgrading-an-angularjs-service" class="docs-anchor" tabindex="-1" aria-label="Link to Upgrading an AngularJS service">升级 AngularJS 服务</a>
  </h3>
  <p>没有用于升级 AngularJS 服务的特定 API。相反，你应该遵循以下指南：</p>
<p>假设你有一个 AngularJS 服务：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> TextFormatter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  titleCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF">((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">^|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\s</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF">)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">[a-z]</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">toUpperCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">());</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// This AngularJS service will be "upgraded" to be used in Angular</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ng1AppModule.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'textFormatter'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, [TextFormatter]);</span></span></code></pre>
  </div><p>然后，您应该定义一个 Angular 提供者，并将其包含在您的 <a href="/api/core/NgModule"><code>NgModule</code></a> 的 <code>providers</code> 属性中。</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Register an Angular provider whose value is the "upgraded" AngularJS service</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: TextFormatter, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">useFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> i.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'textFormatter'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">deps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'$injector'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]},</span></span></code></pre>
  </div><p>然后你可以通过将“升级后”的 AngularJS 服务注入到 Angular 组件或服务中使用它。</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(textFormatter: TextFormatter) {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Change all the hero names to title case, using the "upgraded" AngularJS service</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.heroes.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">hero</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Hero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (hero.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> textFormatter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">titleCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(hero.name)));</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span></code></pre>
  </div></div></div></div>