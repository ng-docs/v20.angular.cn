<div class="docs-api"><header class="docs-reference-header"><span class="docs-reference-category">@angular/cdk/testing</span><div class="docs-reference-title"><div><h1>HarnessEnvironment</h1><div class="docs-api-item-label type-undecorated_class full">类</div></div><a class="docs-github-links" target="_blank" href="https://github.com/angular/components/blob/main/src/cdk/testing/harness-environment.ts#L45-L435" title="View source" aria-label="View source"><i role="presentation" aria-hidden="true" class="material-symbols-outlined">代码</i></a></div><section class="docs-reference-description"><p>基础 harness 环境类，可以被扩展以允许在不同的测试环境（例如 testbed、protractor 等）中使用 <code>ComponentHarness</code>。此类同时实现了 <code>HarnessLoader</code> 和 <code>LocatorFactory</code> 的功能。此类对于特定测试环境使用的原始元素类型 <code>E</code> 是泛型的。</p></section></header><div class="docs-reference-section docs-reference-api-section"><h2 id="api" class="docs-reference-section-heading"><a href="#api" aria-label="Link to API section" tabindex="-1">API</a></h2><div class="docs-code"><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0">    <code>
      <span class="line "><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">abstract</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><button aria-describedby="jump-msg" type="button" class="line " member-id="constructor"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">rawRootElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="rootElement"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   get</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> rootElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/TestElement">TestElement</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="documentRootLocatorFactory"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  documentRootLocatorFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="locatorFor"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[]&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">queries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="locatorForOptional"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[]&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">queries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="locatorForAll"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[]&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">queries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;[]&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="rootHarnessLoader"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  rootHarnessLoader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="harnessLoaderFor"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  harnessLoaderFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="harnessLoaderForOptional"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  harnessLoaderForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="harnessLoaderForAll"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  harnessLoaderForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[]&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getHarness"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  getHarness</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getHarnessOrNull"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  getHarnessOrNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getHarnessAtIndex"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  getHarnessAtIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getAllHarnesses"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  getAllHarnesses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[]&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="countHarnesses"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  countHarnesses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="hasHarness"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  hasHarness</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getChildLoader"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  getChildLoader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getAllChildLoaders"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  getAllChildLoaders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[]&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="createComponentHarness"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> createComponentHarness</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">harnessType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarnessConstructor">ComponentHarnessConstructor</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="forceStabilize"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  abstract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> forceStabilize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="waitForTasksOutsideAngular"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  abstract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> waitForTasksOutsideAngular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getDocumentRoot"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> abstract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> getDocumentRoot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="createTestElement"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> abstract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> createTestElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/TestElement">TestElement</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="createEnvironment"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> abstract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> createEnvironment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="getAllRawElements"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> abstract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> getAllRawElements</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[]&gt;;</span></button><span class="line "><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
    </code>
    </pre></div></div><div class="docs-reference-members"><div class="docs-reference-members"><div id="constructor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>constructor</h3><code><a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a>&lt;E&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">rawRootElement</span><code>E</code><div class="docs-parameter-description"><p>此 <code>HarnessEnvironment</code> 的原生宿主元素。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a>&lt;E&gt;</code></div></div></div></div><div id="rootElement" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>rootElement</h3><code><a href="/api/cdk/testing/TestElement">TestElement</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>此 <code>HarnessEnvironment</code> 的宿主元素，表示为 <code>TestElement</code>。</p></div></div></div></div><div id="rootElement" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>rootElement</h3><code><a href="/api/cdk/testing/TestElement">TestElement</a></code></header><div class="docs-reference-card-body"></div></div><div id="documentRootLocatorFactory" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>documentRootLocatorFactory</h3><code><a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取一个以文档根目录为根的定位器工厂。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></code></div></div></div></div><div id="locatorFor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>locatorFor</h3><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>创建一个异步定位器函数，该函数可用于在此 <code>HarnessEnvironment</code> 的宿主元素下查找 <code>ComponentHarness</code> 实例或元素。</p>
<p>例如，给定以下 DOM 并假设 <code>DivHarness.hostSelector</code> 为 <code>'div'</code></p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d1"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d2"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>那么我们期望：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `DivHarness` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, DivHarness)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `TestElement` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'span'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Throws because the `Promise` rejects</span></span></code></pre>
  </div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">queries</span><code>T</code><div class="docs-parameter-description"><p>要搜索的 harness 和元素的查询列表：</p>

  <ul class="docs-list">
    <li><code>字符串</code>会搜索与该字符串指定的 CSS 选择器匹配的元素。</li>
<li><code>ComponentHarness</code> 构造函数会搜索与给定类匹配的 <code>ComponentHarness</code> 实例。</li>
<li><code>HarnessPredicate</code> 会搜索与给定谓词匹配的 <code>ComponentHarness</code> 实例。</li>

  </ul></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;&gt;</code></div></div></div></div><div id="locatorForOptional" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>locatorForOptional</h3><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt; | null&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>创建一个异步定位器函数，该函数可用于在此 <code>HarnessEnvironment</code> 的宿主元素下查找 <code>ComponentHarness</code> 实例或元素。</p>
<p>例如，给定以下 DOM 并假设 <code>DivHarness.hostSelector</code> 为 <code>'div'</code></p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d1"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d2"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>那么我们期望：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `DivHarness` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, DivHarness)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `TestElement` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'span'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets `null`</span></span></code></pre>
  </div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">queries</span><code>T</code><div class="docs-parameter-description"><p>要搜索的 harness 和元素的查询列表：</p>

  <ul class="docs-list">
    <li><code>字符串</code>会搜索与该字符串指定的 CSS 选择器匹配的元素。</li>
<li><code>ComponentHarness</code> 构造函数会搜索与给定类匹配的 <code>ComponentHarness</code> 实例。</li>
<li><code>HarnessPredicate</code> 会搜索与给定谓词匹配的 <code>ComponentHarness</code> 实例。</li>

  </ul></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt; | null&gt;</code></div></div></div></div><div id="locatorForAll" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>locatorForAll</h3><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;[]&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>创建一个异步定位器函数，该函数可用于在此 <code>HarnessEnvironment</code> 的宿主元素下查找 <code>ComponentHarness</code> 实例或元素。</p>
<p>例如，给定以下 DOM 并假设 <code>DivHarness.hostSelector</code> 为 <code>'div'</code> 且 <code>IdIsD1Harness.hostSelector</code> 为 <code>'#d1'</code></p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d1"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d2"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>那么我们期望：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets [DivHarness for #d1, TestElement for #d1, DivHarness for #d2, TestElement for #d2]</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets [TestElement for #d1, TestElement for #d2]</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'#d1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets [DivHarness for #d1, IdIsD1Harness for #d1, DivHarness for #d2]</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, IdIsD1Harness)()</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets []</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lf.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'span'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()</span></span></code></pre>
  </div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">queries</span><code>T</code><div class="docs-parameter-description"><p>要搜索的 harness 和元素的查询列表：</p>

  <ul class="docs-list">
    <li><code>字符串</code>会搜索与该字符串指定的 CSS 选择器匹配的元素。</li>
<li><code>ComponentHarness</code> 构造函数会搜索与给定类匹配的 <code>ComponentHarness</code> 实例。</li>
<li><code>HarnessPredicate</code> 会搜索与给定谓词匹配的 <code>ComponentHarness</code> 实例。</li>

  </ul></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;[]&gt;</code></div></div></div></div><div id="rootHarnessLoader" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>rootHarnessLoader</h3><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>&gt;</code></div></div></div></div><div id="harnessLoaderFor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>harnessLoaderFor</h3><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取此 <code>HarnessEnvironment</code> 根目录下的元素的 <code>HarnessLoader</code> 实例。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">selector</span><code>string</code><div class="docs-parameter-description"><p>宿主元素的选择器。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>&gt;</code></div></div></div></div><div id="harnessLoaderForOptional" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>harnessLoaderForOptional</h3><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a> | null&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取此 <code>HarnessEnvironment</code> 根目录下的元素的 <code>HarnessLoader</code> 实例。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">selector</span><code>string</code><div class="docs-parameter-description"><p>宿主元素的选择器。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a> | null&gt;</code></div></div></div></div><div id="harnessLoaderForAll" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>harnessLoaderForAll</h3><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>[]&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取 <code>HarnessLoader</code> 实例列表，每个匹配的元素对应一个实例。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">selector</span><code>string</code><div class="docs-parameter-description"><p>宿主元素的选择器。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>[]&gt;</code></div></div></div></div><div id="getHarness" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getHarness</h3><code>Promise&lt;T&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在 <code>HarnessEnvironment</code> 的宿主元素下搜索给定 harness 类型的对应组件实例，并返回该实例的 <code>ComponentHarness</code>。如果找到多个匹配的组件，则返回第一个组件的 harness。如果未找到匹配的组件，则抛出错误。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">query</span><code><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a>&lt;T&gt;</code><div class="docs-parameter-description"><p>用于创建测试工具的查询</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;T&gt;</code></div></div></div></div><div id="getHarnessOrNull" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getHarnessOrNull</h3><code>Promise&lt;T | null&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在 <code>HarnessEnvironment</code> 的宿主元素下搜索给定 harness 类型的对应组件实例，并返回该实例的 <code>ComponentHarness</code>。如果找到多个匹配的组件，则返回第一个组件的 harness。如果未找到匹配的组件，则返回 null。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">query</span><code><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a>&lt;T&gt;</code><div class="docs-parameter-description"><p>用于创建测试工具的查询</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;T | null&gt;</code></div></div></div></div><div id="getHarnessAtIndex" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getHarnessAtIndex</h3><code>Promise&lt;T&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在 <code>HarnessEnvironment</code> 的宿主元素下搜索给定 harness 类型和索引的对应组件实例，并返回该实例的 <code>ComponentHarness</code>。索引指定了要查找的组件的偏移量。如果在该索引处未找到匹配的组件，则会抛出错误。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">query</span><code><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a>&lt;T&gt;</code><div class="docs-parameter-description"><p>用于创建测试工具的查询</p></div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">offset</span><code>number</code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;T&gt;</code></div></div></div></div><div id="getAllHarnesses" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getAllHarnesses</h3><code>Promise&lt;T[]&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在 <code>HarnessEnvironment</code> 的宿主元素下搜索给定 harness 类型的对应组件的所有实例，并为每个实例返回一个 <code>ComponentHarness</code> 列表。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">query</span><code><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a>&lt;T&gt;</code><div class="docs-parameter-description"><p>用于创建测试工具的查询</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;T[]&gt;</code></div></div></div></div><div id="countHarnesses" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>countHarnesses</h3><code>Promise&lt;number&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在 <a href="/api/cdk/testing/HarnessEnvironment"><code>HarnessEnvironment</code></a> 的根元素下搜索给定测试工具类型的组件的所有实例，并返回找到的数量。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">query</span><code><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a>&lt;T&gt;</code><div class="docs-parameter-description"><p>用于创建测试工具的查询</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;number&gt;</code></div></div></div></div><div id="hasHarness" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>hasHarness</h3><code>Promise&lt;boolean&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在 <a href="/api/cdk/testing/HarnessEnvironment"><code>HarnessEnvironment</code></a> 的根元素下搜索给定测试工具类型的组件的实例，并返回一个布尔值，指示是否找到任何实例。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">query</span><code><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a>&lt;T&gt;</code><div class="docs-parameter-description"><p>用于创建测试工具的查询</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;boolean&gt;</code></div></div></div></div><div id="getChildLoader" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getChildLoader</h3><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在环境的根元素下搜索具有给定选择器的元素，并返回一个以匹配元素为根的 <a href="/api/cdk/testing/HarnessLoader"><code>HarnessLoader</code></a>。如果多个元素匹配选择器，则使用第一个。如果没有元素匹配，则抛出错误。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">selector</span><code>string</code><div class="docs-parameter-description"><p>新 <a href="/api/cdk/testing/HarnessLoader"><code>HarnessLoader</code></a> 的根元素的选择器</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>&gt;</code></div></div></div></div><div id="getAllChildLoaders" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getAllChildLoaders</h3><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>[]&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在环境的根元素下搜索具有给定选择器的所有元素，并返回一个 <a href="/api/cdk/testing/HarnessLoader"><code>HarnessLoader</code></a> 数组，每个匹配元素对应一个，以该元素为根。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">selector</span><code>string</code><div class="docs-parameter-description"><p>新 <a href="/api/cdk/testing/HarnessLoader"><code>HarnessLoader</code></a> 的根元素的选择器</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/HarnessLoader">HarnessLoader</a>[]&gt;</code></div></div></div></div><div id="createComponentHarness" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>createComponentHarness</h3><code>T</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>为给定的测试工具类型和给定的原始宿主元素创建一个 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a>。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">harnessType</span><code><a href="/api/cdk/testing/ComponentHarnessConstructor">ComponentHarnessConstructor</a>&lt;T&gt;</code><div class="docs-parameter-description"></div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">element</span><code>E</code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>T</code></div></div></div></div><div id="forceStabilize" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>forceStabilize</h3><code>Promise&lt;void&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>刷新在 Angular Zone 中捕获的变更检测和异步任务。
在大多数情况下，无需手动调用此方法。但是，在某些边缘情况下，可能需要它来完全刷新动画事件。
这是一个必须由子类实现的抽象方法。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;void&gt;</code></div></div></div></div><div id="waitForTasksOutsideAngular" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>waitForTasksOutsideAngular</h3><code>Promise&lt;void&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>等待所有已计划或正在运行的异步任务完成。这允许测试工具作者等待 Angular Zone 之外的异步任务。
这是一个必须由子类实现的抽象方法。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;void&gt;</code></div></div></div></div><div id="getDocumentRoot" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getDocumentRoot</h3><code>E</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取文档的根元素。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>E</code></div></div></div></div><div id="createTestElement" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>createTestElement</h3><code><a href="/api/cdk/testing/TestElement">TestElement</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>从原始元素创建 <a href="/api/cdk/testing/TestElement"><code>TestElement</code></a>。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">element</span><code>E</code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/cdk/testing/TestElement">TestElement</a></code></div></div></div></div><div id="createEnvironment" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>createEnvironment</h3><code><a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a>&lt;E&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在给定的原始元素下创建一个 <a href="/api/cdk/testing/HarnessEnvironment"><code>HarnessEnvironment</code></a>。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">element</span><code>E</code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/cdk/testing/HarnessEnvironment">HarnessEnvironment</a>&lt;E&gt;</code></div></div></div></div><div id="getAllRawElements" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>getAllRawElements</h3><code>Promise&lt;E[]&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取此环境根元素下匹配给定选择器的所有元素的列表。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">selector</span><code>string</code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;E[]&gt;</code></div></div></div></div></div></div></div>