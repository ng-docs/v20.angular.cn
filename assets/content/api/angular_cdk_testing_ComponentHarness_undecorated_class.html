<div class="docs-api"><header class="docs-reference-header"><span class="docs-reference-category">@angular/cdk/testing</span><div class="docs-reference-title"><div><h1>ComponentHarness</h1><div class="docs-api-item-label type-undecorated_class full">类</div></div><a class="docs-github-links" target="_blank" href="https://github.com/angular/components/blob/main/src/cdk/testing/component-harness.ts#L324-L473" title="View source" aria-label="View source"><i role="presentation" aria-hidden="true" class="material-symbols-outlined">代码</i></a></div><section class="docs-reference-description"><p>所有组件工具链作者都应扩展的组件测试工具链的基类。此基组件工具链提供了定位元素和子组件工具链的基本能力。</p></section></header><div class="docs-reference-section docs-reference-api-section"><h2 id="api" class="docs-reference-section-heading"><a href="#api" aria-label="Link to API section" tabindex="-1">API</a></h2><div class="docs-code"><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0">    <code>
      <span class="line "><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">abstract</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><button aria-describedby="jump-msg" type="button" class="line " member-id="constructor"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">locatorFactory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="host"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/TestElement">TestElement</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="documentRootLocatorFactory"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> documentRootLocatorFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="locatorFor"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[]&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">queries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="locatorForOptional"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[]&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">queries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="locatorForAll"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/HarnessQuery">HarnessQuery</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[]&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">queries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;[]&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="forceStabilize"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> forceStabilize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="waitForTasksOutsideAngular"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  protected</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> waitForTasksOutsideAngular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><span class="line "><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
    </code>
    </pre></div></div><div class="docs-reference-members"><div class="docs-reference-members"><div id="constructor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>constructor</h3><code><a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">locatorFactory</span><code><a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/cdk/testing/ComponentHarness">ComponentHarness</a></code></div></div></div></div><div id="host" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>host</h3><code>Promise&lt;<a href="/api/cdk/testing/TestElement">TestElement</a>&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取代表组件宿主元素的 <code>TestElement</code> 的 <code>Promise</code>。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;<a href="/api/cdk/testing/TestElement">TestElement</a>&gt;</code></div></div></div></div><div id="documentRootLocatorFactory" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>documentRootLocatorFactory</h3><code><a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>获取文档根元素的 <a href="/api/cdk/testing/LocatorFactory"><code>LocatorFactory</code></a>。此工厂可用于创建组件在其自身根元素之外创建的元素的定位器（例如，通过附加到 document.body）。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/cdk/testing/LocatorFactory">LocatorFactory</a></code></div></div></div></div><div id="locatorFor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>locatorFor</h3><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>创建一个异步定位器函数，可用于查找此 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a> 的宿主元素下的 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a> 实例或元素。</p>
<p>例如，给定以下 DOM 并假设 <code>DivHarness.hostSelector</code> 为 <code>'div'</code></p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d1"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d2"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>那么我们期望：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `DivHarness` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, DivHarness)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `TestElement` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'span'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Throws because the `Promise` rejects</span></span></code></pre>
  </div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">queries</span><code>T</code><div class="docs-parameter-description"><p>要搜索的工具链和元素的查询列表：</p>

  <ul class="docs-list">
    <li><code>string</code> 会搜索与字符串指定的 CSS 选择器匹配的元素。</li>
<li><code>ComponentHarness</code> 构造函数会搜索与给定类匹配的 <code>ComponentHarness</code> 实例。</li>
<li><code>HarnessPredicate</code> 会搜索与给定谓词匹配的 <code>ComponentHarness</code> 实例。</li>

  </ul></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;&gt;</code></div></div></div></div><div id="locatorForOptional" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>locatorForOptional</h3><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt; | null&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>创建一个异步定位器函数，可用于查找此 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a> 的宿主元素下的 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a> 实例或元素。</p>
<p>例如，给定以下 DOM 并假设 <code>DivHarness.hostSelector</code> 为 <code>'div'</code></p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d1"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d2"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>那么我们期望：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `DivHarness` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, DivHarness)() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets a `TestElement` instance for #d1</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForOptional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'span'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets `null`</span></span></code></pre>
  </div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">queries</span><code>T</code><div class="docs-parameter-description"><p>要搜索的工具链和元素的查询列表：</p>

  <ul class="docs-list">
    <li><code>string</code> 会搜索与字符串指定的 CSS 选择器匹配的元素。</li>
<li><code>ComponentHarness</code> 构造函数会搜索与给定类匹配的 <code>ComponentHarness</code> 实例。</li>
<li><code>HarnessPredicate</code> 会搜索与给定谓词匹配的 <code>ComponentHarness</code> 实例。</li>

  </ul></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt; | null&gt;</code></div></div></div></div><div id="locatorForAll" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>locatorForAll</h3><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;[]&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>创建一个异步定位器函数，可用于查找此 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a> 的宿主元素下的 <a href="/api/cdk/testing/ComponentHarness"><code>ComponentHarness</code></a> 实例或元素。</p>
<p>例如，给定以下 DOM 并假设 <code>DivHarness.hostSelector</code> 为 <code>'div'</code> 且 <code>IdIsD1Harness.hostSelector</code> 为 <code>'#d1'</code></p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d1"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"d2"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>那么我们期望：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets [DivHarness for #d1, TestElement for #d1, DivHarness for #d2, TestElement for #d2]</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets [TestElement for #d1, TestElement for #d2]</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'#d1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets [DivHarness for #d1, IdIsD1Harness for #d1, DivHarness for #d2]</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(DivHarness, IdIsD1Harness)()</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Gets []</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">locatorForAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'span'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)()</span></span></code></pre>
  </div></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">queries</span><code>T</code><div class="docs-parameter-description"><p>要搜索的工具链和元素的查询列表：</p>

  <ul class="docs-list">
    <li><code>string</code> 会搜索与字符串指定的 CSS 选择器匹配的元素。</li>
<li><code>ComponentHarness</code> 构造函数会搜索与给定类匹配的 <code>ComponentHarness</code> 实例。</li>
<li><code>HarnessPredicate</code> 会搜索与给定谓词匹配的 <code>ComponentHarness</code> 实例。</li>

  </ul></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>() =&gt; Promise&lt;<a href="/api/cdk/testing/LocatorFnResult">LocatorFnResult</a>&lt;T&gt;[]&gt;</code></div></div></div></div><div id="forceStabilize" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>forceStabilize</h3><code>Promise&lt;void&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>刷新 Angular 区域中的更改检测和异步任务。
在大多数情况下，无需手动调用此方法。但是，在某些边缘情况下，可能需要调用此方法来完全刷新动画事件。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;void&gt;</code></div></div></div></div><div id="waitForTasksOutsideAngular" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>waitForTasksOutsideAngular</h3><code>Promise&lt;void&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>等待所有已计划或正在运行的异步任务完成。这允许工具链作者等待 Angular 区域之外的异步任务。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;void&gt;</code></div></div></div></div></div></div></div>