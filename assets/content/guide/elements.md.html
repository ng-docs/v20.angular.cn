<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1">Angular Element 概览</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/elements.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p><em>Angular Element</em> 是打包为<em>自定义元素</em>（也称为 Web Components）的 Angular 组件，自定义元素是一种以框架无关的方式定义新的 HTML 元素的 Web 标准。</p>
<p><a href="https://developer.mozilla.org/docs/Web/Web_Components/Using_custom_elements" target="_blank">自定义元素</a>是 Web 平台的一项特性，在 Angular 支持的所有浏览器上均可用。
自定义元素扩展了 HTML，允许你定义一个标签，其内容由 JavaScript 代码创建和控制。
浏览器维护着已定义自定义元素的 <code>CustomElementRegistry</code>，它将可实例化的 JavaScript 类映射到 HTML 标签。</p>
<p><code>@angular/elements</code> 包导出了一个 <a href="/api/elements/createCustomElement"><code>createCustomElement()</code></a> API，它提供了从 Angular 的组件接口和变更检测功能到内置 DOM API 的桥梁。</p>
<p>将组件转换为自定义元素，使所有必需的 Angular 基础架构都可用于浏览器。
创建自定义元素既简单又直接，并且会自动将你组件定义的视图与变更检测和数据绑定连接起来，从而将 Angular 功能映射到相应的内置 HTML 等效项。</p>

  <h2 id="using-custom-elements">
    <a href="#using-custom-elements" class="docs-anchor" tabindex="-1" aria-label="Link to Using custom elements">使用自定义元素</a>
  </h2>
  <p>自定义元素会自行启动 —— 它们在添加到 DOM 时启动，并在从 DOM 中移除时销毁。
一旦将自定义元素添加到任何页面的 DOM 中，它的外观和行为都类似于任何其他 HTML 元素，并且不需要任何关于 Angular 术语或用法约定的专门知识。</p>
<p>要将 <code>@angular/elements</code> 包添加到你的工作区，请运行以下命令：</p>
<div class="docs-code shell">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/elements</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --save</span></span></code></pre>
  </div>
  <h3 id="how-it-works">
    <a href="#how-it-works" class="docs-anchor" tabindex="-1" aria-label="Link to How it works">它是如何工作的</a>
  </h3>
  <p><code>createCustomElement()</code> 函数将组件转换为一个类，该类可以作为自定义元素注册到浏览器。
在将配置好的类注册到浏览器的自定义元素注册表中后，就可以像使用内置 HTML 元素一样使用新元素来处理直接添加到 DOM 中的内容：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">my-popup</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Use Angular!"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">my-popup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
  </div><p>当你的自定义元素放置在页面上时，浏览器会创建已注册类的实例并将其添加到 DOM 中。
内容由组件的模板提供，该模板使用 Angular 模板语法，并使用组件和 DOM 数据进行渲染。
组件中的输入属性（Property）对应于元素的输入属性（Attribute）。</p>

  <h2 id="transforming-components-to-custom-elements">
    <a href="#transforming-components-to-custom-elements" class="docs-anchor" tabindex="-1" aria-label="Link to Transforming components to custom elements">将组件转换为自定义元素</a>
  </h2>
  <p>Angular 提供了 <a href="/api/elements/createCustomElement"><code>createCustomElement()</code></a> 函数，用于将 Angular 组件及其依赖项转换为自定义元素。</p>
<p>转换过程实现了 <a href="/api/elements/NgElementConstructor"><code>NgElementConstructor</code></a> 接口，并创建一个构造函数类，该类配置为生成组件的自举实例。</p>
<p>使用浏览器原生的 <a href="https://developer.mozilla.org/docs/Web/API/CustomElementRegistry/define" target="_blank"><code>customElements.define()</code></a> 函数来注册配置的构造函数及其关联的自定义元素标签到浏览器的 <a href="https://developer.mozilla.org/docs/Web/API/CustomElementRegistry" target="_blank"><code>CustomElementRegistry</code></a>。
当浏览器遇到已注册元素的标签时，它会使用该构造函数来创建自定义元素实例。</p>

    <div class="docs-alert docs-alert-important">
    <p><strong>重要提示：</strong> 避免使用组件的选择器作为自定义元素标签名。
这可能会导致意外行为，因为 Angular 会为一个 DOM 元素创建两个组件实例：
一个常规 Angular 组件和第二个使用自定义元素的组件。</p>

    </div>
    
  <h3 id="mapping">
    <a href="#mapping" class="docs-anchor" tabindex="-1" aria-label="Link to Mapping">映射</a>
  </h3>
  <p>自定义元素<em>宿主</em>一个 Angular 组件，在组件中定义的数据和逻辑与标准 DOM API 之间架起了一座桥梁。
组件属性（Property）和逻辑直接映射到 HTML 属性（Attribute）和浏览器的事件系统。</p>

  <ul class="docs-list">
    <li><p>创建 API 会解析组件以查找输入属性，并为自定义元素定义相应的属性。
它会转换属性名，使其与不区分大小写的自定义元素兼容。
生成的属性名使用连字符分隔的小写形式。
例如，对于一个具有 <code>inputProp = input({alias: 'myInputProp'})</code> 的组件，相应的自定义元素会定义一个 <code>my-input-prop</code> 属性。</p>
</li>
<li><p>组件的输出会作为 HTML <a href="https://developer.mozilla.org/docs/Web/API/CustomEvent" target="_blank">自定义事件</a>进行分派，自定义事件的名称与输出名称匹配。
  例如，对于一个具有 <code>valueChanged = output()</code> 的组件，相应的自定义元素会分派名为 "valueChanged" 的事件，并且发出的数据存储在事件的 <code>detail</code> 属性上。
  如果你提供了别名，则会使用该别名；例如，<code>clicks = output&lt;string&gt;({alias: 'myClick'});</code> 会导致分派名为 "myClick" 的事件。</p>
</li>

  </ul>
  <p>有关更多信息，请参阅 Web Component 文档，了解 <a href="https://developer.mozilla.org/docs/Web/Guide/Events/Creating_and_triggering_events#Creating_custom_events" target="_blank">创建自定义事件</a>。</p>

  <h2 id="example-a-popup-service">
    <a href="#example-a-popup-service" class="docs-anchor" tabindex="-1" aria-label="Link to Example: A Popup Service">范例：弹出服务</a>
  </h2>
  <p>以前，当你想在运行时向应用添加组件时，你必须定义一个<em>动态组件</em>，然后你必须加载它，将其附着到 DOM 中的元素，并连接所有依赖项、变更检测和事件处理。</p>
<p>通过使用 Angular 自定义元素，可以自动提供所有基础架构和框架，从而使过程更简单、更透明 —— 你只需定义你想要的事件处理类型即可。
（如果你不打算在你的应用中使用该组件，你仍然必须将其从编译中排除。）</p>
<p>以下“弹出服务”范例应用定义了一个组件，你可以动态加载该组件，也可以将其转换为自定义元素。</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left">文件</th>
<th align="left">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left"><code>popup.component.ts</code></td>
<td align="left">定义了一个简单的弹出元素，用于显示输入消息，并带有一些动画和样式。</td>
</tr>
<tr>
<td align="left"><code>popup.service.ts</code></td>
<td align="left">创建一个可注入的服务，该服务提供了两种不同的方式来调用 <code>PopupComponent</code>；作为动态组件或作为自定义元素。请注意，动态加载方法需要更多的建立（set up）工作。</td>
</tr>
<tr>
<td align="left"><code>app.component.ts</code></td>
<td align="left">定义应用的根组件，该组件使用 <code>PopupService</code> 在运行时将弹出窗口添加到 DOM。当应用运行时，根组件的构造函数会将 <code>PopupComponent</code> 转换为自定义元素。</td>
</tr>

      </tbody>
    </table>
  </div>
  <p>为了进行比较，演示展示了两种方法。
一个按钮使用动态加载方法添加弹出窗口，另一个按钮使用自定义元素。
结果是相同的，但准备工作是不同的。</p>
<div class="docs-code-multifile">
    <div class="docs-code" path="adev/src/content/examples/elements/src/app/popup.component.ts" header="popup.component.ts">
    <div class="docs-code-header"><h3>popup.component.ts</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {<a href="/api/core/Component">Component</a>, computed, input, output} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {animate, state, style, transition, trigger} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/animations'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'my-popup'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &lt;span&gt;Popup: {{ message }}&lt;/span&gt;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &lt;button type="button" (click)="closed.next()"&gt;✖&lt;/button&gt;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  animations: [</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    <a href="/api/animations/trigger">trigger</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'<a href="/api/animations/state">state</a>'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, [</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      <a href="/api/animations/state">state</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'opened'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/animations/style">style</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({transform: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'translateY(0%)'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})),</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      <a href="/api/animations/state">state</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'void, closed'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/animations/style">style</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({transform: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'translateY(100%)'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, opacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})),</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      <a href="/api/animations/transition">transition</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'* =&gt; *'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">animate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'100ms ease-in'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)),</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]),</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styles: [</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    `</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      :host {</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        position: absolute;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        bottom: 0;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        left: 0;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        right: 0;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        background: #009cff;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        height: 48px;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        padding: 16px;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        display: flex;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        justify-content: space-between;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        align-items: center;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        border-top: 1px solid black;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        font-size: 24px;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      button {</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        border-radius: 50%;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      }</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    `</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  host: {</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    '[@<a href="/api/animations/state">state</a>]'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'<a href="/api/animations/state">state</a>()'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  },</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> PopupComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/input">input</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> closed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/output">output</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;();</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> <a href="/api/animations/state">state</a></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/computed">computed</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'opened'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'closed'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span><span class="line"></span></code></pre>
  </div><div class="docs-code" path="adev/src/content/examples/elements/src/app/popup.service.ts" header="popup.service.ts">
    <div class="docs-code-header"><h3>popup.service.ts</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {<a href="/api/core/ApplicationRef">ApplicationRef</a>, createComponent, EnvironmentInjector, Injectable} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {<a href="/api/elements/NgElement">NgElement</a>, WithProperties} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/elements'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {PopupComponent} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './popup.component'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Injectable">Injectable</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> PopupService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/EnvironmentInjector">EnvironmentInjector</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> applicationRef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/ApplicationRef">ApplicationRef</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ) {}</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // Previous dynamic-loading method required you to set up infrastructure</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // before adding the popup to the DOM.</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  showAsComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Create element</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> popup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'popup-component'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Create the component and wire it up with the element</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> popupComponentRef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/createComponent">createComponent</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(PopupComponent, {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      environmentInjector: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.injector,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      hostElement: popup,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Attach to the view so that the change detector knows to run</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.applicationRef.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">attachView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(popupComponentRef.hostView);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Listen to the close event</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    popupComponentRef.instance.closed.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">subscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(popup);</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.applicationRef.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">detachView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(popupComponentRef.hostView);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Set the message</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    popupComponentRef.instance.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> message;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Add to the DOM</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(popup);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // This uses the new custom-element method to add the popup to the DOM.</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  showAsElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Create element</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> popupEl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/NgElement">NgElement</a></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/WithProperties">WithProperties</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PopupComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      'popup-element'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Listen to the close event</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    popupEl.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'closed'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(popupEl));</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Set the message</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    popupEl.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> message;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Add to the DOM</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(popupEl);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span><span class="line"></span></code></pre>
  </div><div class="docs-code" path="adev/src/content/examples/elements/src/app/app.component.ts" header="app.component.ts">
    <div class="docs-code-header"><h3>app.component.ts</h3></div>
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {<a href="/api/core/Component">Component</a>, Injector} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {<a href="/api/elements/createCustomElement">createCustomElement</a>} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/elements'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {PopupComponent} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './popup.component'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {PopupService} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './popup.service'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-root'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &lt;<a href="/api/core/input">input</a> #input value="Message" /&gt;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &lt;button type="button" (click)="popup.showAsComponent(input.value)"&gt;Show as component&lt;/button&gt;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &lt;button type="button" (click)="popup.showAsElement(input.value)"&gt;Show as element&lt;/button&gt;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [PopupService],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  imports: [PopupComponent],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">    injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/core/Injector">Injector</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> popup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> PopupService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ) {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Convert `PopupComponent` to a custom element.</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> PopupElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/createCustomElement">createCustomElement</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(PopupComponent, {injector});</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Register the custom element with the browser.</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    customElements.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">define</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'popup-element'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, PopupElement);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span><span class="line"></span></code></pre>
  </div>
    </div>
  <h2 id="typings-for-custom-elements">
    <a href="#typings-for-custom-elements" class="docs-anchor" tabindex="-1" aria-label="Link to Typings for custom elements">自定义元素的类型定义</a>
  </h2>
  <p>通用 DOM API，例如 <code>document.createElement()</code> 或 <code>document.querySelector()</code>，返回适合指定参数的元素类型。
例如，调用 <code>document.createElement('a')</code> 返回 <code>HTMLAnchorElement</code>，TypeScript 知道它具有 <code>href</code> 属性（Property）。
同样，<code>document.createElement('div')</code> 返回 <code>HTMLDivElement</code>，TypeScript 知道它没有 <code>href</code> 属性（Property）。</p>
<p>当使用未知元素（例如，我们的示例中的自定义元素名称 <code>popup-element</code>）调用时，这些方法会返回通用类型，例如 <code>HTMLElement</code>，因为 TypeScript 无法推断返回元素的正确类型。</p>
<p>使用 Angular 创建的自定义元素会扩展 <a href="/api/elements/NgElement"><code>NgElement</code></a>（它又扩展了 <code>HTMLElement</code>）。
此外，这些自定义元素将为相应组件的每个输入属性提供一个属性。
例如，我们的 <code>popup-element</code> 有一个类型为 <code>string</code> 的 <code>message</code> 属性。</p>
<p>如果你想为你的自定义元素获取正确的类型，有几种选择。
假设你基于以下组件创建了一个 <code>my-dialog</code> 自定义元素：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"><a href="/api/core/Component">Component</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(…)</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MyDialog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  <a href="/api/core/input">input</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(string);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>获取准确类型定义的最直接方法是将相关 DOM 方法的返回值转换为正确的类型。
为此，请使用 <a href="/api/elements/NgElement"><code>NgElement</code></a> 和 <a href="/api/elements/WithProperties"><code>WithProperties</code></a> 类型（均从 <code>@angular/elements</code> 导出）：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> aDialog</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'my-dialog'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/NgElement">NgElement</a></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/WithProperties">WithProperties</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;{</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}&gt;;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">aDialog.content </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'Hello, world!'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">aDialog.content </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// &lt;-- ERROR: TypeScript knows this should be a string.</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">aDialog.body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'News'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// &lt;-- ERROR: TypeScript knows there is no `body` property on `aDialog`.</span></span></code></pre>
  </div><p>对于你的自定义元素，这是快速获取 TypeScript 特性（例如类型检查和自动完成支持）的好方法。
但是，如果你在多个地方需要它，它可能会变得很麻烦，因为你必须在每次出现时都强制转换返回类型。</p>
<p>另一种替代方案是增强 <code>HTMLElementTagNameMap</code>，它只需要定义一次每个自定义元素的类型。TypeScript 使用 <code>HTMLElementTagNameMap</code> 基于返回元素的标签名（对于 DOM 方法，如 <code>document.createElement()</code>、<code>document.querySelector()</code> 等）来推断返回元素的类型：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">declare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> global {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HTMLElementTagNameMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    'my-dialog'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/NgElement">NgElement</a></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/WithProperties">WithProperties</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;{</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}&gt;;</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    'my-other-element'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/NgElement">NgElement</a></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/elements/WithProperties">WithProperties</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;{</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">foo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'bar'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}&gt;;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    …</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
  </div><p>现在，TypeScript 可以像推断内置元素一样推断出正确的类型：</p>
<div class="docs-code">
    
    <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'div'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//--&gt; HTMLDivElement (built-in element)</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">querySelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'foo'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//--&gt; Element        (unknown element)</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'my-dialog'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//--&gt; <a href="/api/elements/NgElement">NgElement</a> &amp; WithProperties&lt;{content: string}&gt; (custom element)</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">querySelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'my-other-element'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//--&gt; <a href="/api/elements/NgElement">NgElement</a> &amp; WithProperties&lt;{foo: 'bar'}&gt;      (custom element)</span></span></code></pre>
  </div>
  <h2 id="limitations">
    <a href="#limitations" class="docs-anchor" tabindex="-1" aria-label="Link to Limitations">局限性</a>
  </h2>
  <p>由于 <a href="https://github.com/angular/angular/issues/38778" target="_blank">disconnect()</a> 回调的问题，销毁然后再重新附着用 <code>@angular/elements</code> 创建的自定义元素时应谨慎。您可能会遇到此问题的场景包括：</p>

  <ul class="docs-list">
    <li>在 <code>AngularJs</code> 的 <code>ng-if</code> 或 <code>ng-repeat</code> 中渲染组件</li>
<li>手动从 DOM 中分离和重新附着元素</li>

  </ul>
  